
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Music Recommendation Turntable</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sofia">

    <script src="https://unpkg.com/vue@3.3.4/dist/vue.global.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Special+Gothic+Expanded+One&display=swap');

        .lava-lamp-container {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            overflow: hidden;
            background-color: #000;
            background: linear-gradient(0deg,rgba(100, 20, 0, 1) 1%, rgba(0, 0, 0, 1) 99%);

        }
        
        .metaballs {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        .metasvg {
            position: fixed;
            height: 120vh;
            width: 120vw;
            top: -20px;
            left: -20px;
            overflow: visible;
        }
        
        .blobb {
            fill: url(#lavaGradient);
            opacity: 0.85;
            mix-blend-mode: screen;
            transform-origin: center;
            filter: url(#glowing);
        }


        body {
            font-family: "Arial", sans-serif;
            background: none;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: auto;
            color: white;
        }

        @keyframes moveBackground {
            0% {
              background-position: 0% 100%; /* bottom-left */
            }
            100% {
              background-position: 100% 0%; /* top-right */
            }
        }          
        
        .container {
            max-width: 750px;
            width: 100%;
            margin: 30px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-family: "Special Gothic Expanded One", sans-serif;
            font-weight: 700;
            font-style: italic;
            font-size: 2.5rem;
            color: #FFF;
            margin: 0px;
            text-shadow: #fff 0 0 10px;
        }

        p {

        }
        
        .turntable {
            width: auto;
            max-width: 900px;
            padding: 2%;
            background: linear-gradient(0deg,rgba(186, 47, 0, 0.5) 1%, rgba(255, 195, 0, 0.5) 99%);
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            margin: 0 auto;
            box-sizing: border-box;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .turntable-deck {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            flex-wrap: nowrap;
            width: 100%;
        }
        
        
        .record-player {
            flex-shrink: 0;
            width: 400px;
            height: 400px;
            position: relative;
        }      
        
        .record-base {
            width: 100%;
            height: 100%;
            background-color: rgba(10, 0, 0, 0.85);
            border-radius: 50%;
            position: absolute;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }
        
        .record {
            width: 95%;
            height: 95%;
            background-color: #111;
            border-radius: 50%;
            position: absolute;
            top: 2.5%;
            left: 2.5%;
            animation: spin 10s linear infinite paused;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .record.playing {
            animation-play-state: running;
        }
        
        .record::after {
            content: '';
            width: 5%;
            height: 5%;
            background-color: #000000;
            border-radius: 50%;
            position: absolute;
            z-index: 2;
        }

        .record::before {
            content: '';
            width: 15%;
            height: 15%;
            border-radius: 50%;
            position: absolute;
            border: solid 1px rgba(255, 255, 255, 0.2);
            z-index: 1;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            backdrop-filter: blur(1px);
            -webkit-backdrop-filter: blur(1px);
        }
        
        .record-grooves {
            position: absolute;
            width: 100%;
            height: 100%;
            background: repeating-radial-gradient(
                circle at center,
                #111 1px,
                #222 6px
            );
        }
        
        .album-cover {
            width: 55%;
            height: 55%;
            border-radius: 50%;
            border: solid 5px #ff8530;
            position: absolute;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .album-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .album-cover-placeholder {
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #666;
            font-size: 12px;
            text-align: center;
            padding: 10px;
        }
        
        .record-arm {
            position: absolute;
            width: 150px;
            height: 10px;
            background-color: #555;
            top: 50px;
            right: -30px;
            transform-origin: right center;
            transform: rotate(-90deg);
            z-index: 50;
            border-radius: 5px;
            transition: transform 0.5s ease;
        }
        
        .record-arm::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #666;
            border-radius: 25%;
            left: 0;
            top: 0;
        }
        
        .knob-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px;
            width: 120px;
        }
        
        .knob {
            width: 70px;
            height: 70px;
            background-color: rgba(50, 50, 50, 0.8);
            border-radius: 50%;
            border: solid 5px rgba(0, 0, 0, 0.3);
            position: relative;
            cursor: grab;
            box-shadow: 0 0 15px #552000;
            user-select: none;
            transition: transform 0.1s ease-out;
            margin: 5px;
        }

        .knob-active {
            cursor: grabbing;
            transform-origin: center !important;
            transform: scale(1.2);
        }
        
        .knob::after {
            content: '';
            position: absolute;
            top: 10%;
            left: 50%;
            width: 2px;
            height: 20%;
            background-color: white;
            transform: translateX(-50%);
        }
        
        .knob-label {
            font-size: 0.9rem;
            text-align: center;
            color: #fff;
            font-weight: bold;
        }
        
        .knob-value {
            background-color: white;
            border: solid 2px #FE9900;
            color: #FE9900;
            border-radius: 50px;
            font-size: 0.8rem;
            text-align: center;
            font-weight: bold;
            height: 1rem;
            padding: 5px 10px;
            margin-bottom: 20px;
        }

        .mode-knob-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px;
            width: 120px;
        }

        .knob-container button{
            padding: 5px 20px;
            background-color: white;
            color: #FE9900;
            border: outset 2px #FE9900;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .knob-container button:hover{
            transform: scale(1.1);
            background-color: white
        }
        
        .search-container {
            width: 100%;
            margin: 20px auto 0;
            position: relative;
            box-sizing: border-box;
        }
        
        .search-input-container {
            position: relative;
        }
        
        .search-input {
            background-color: rgba(0, 0, 0, 0.6);
            border: none;
            color: white;
            padding: 12px 15px;
            border-radius: 100px;
            font-size: 1rem;
            width: 100%;
            box-sizing: border-box;
        }

        ::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        /* Slider control */
        .slider-vertical-container {
            flex-shrink: 0;
            height: 300px;
            width: 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .recommendation-slider-vertical {
            -webkit-appearance: none;
            appearance: none;
            width: 300px;
            height: 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 5px;
            outline: none;
            margin: 0;
            position: absolute;
            transform: rotate(270deg);
            transform-origin: center;
        }
        
        .recommendation-slider-vertical::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 40px;
            background: #333;
            border-left: inset 2px #666;
            border-right: inset 2px #000;
            box-shadow: -5px 0px 10px #552000;
            cursor: grab;
        }

        /* Tooltip styles */
        .slider-vertical-container::before {
            content: "Recommendation count";
            position: absolute;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 12px;
            white-space: wrap;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 1000;
            pointer-events: none;
        }

        .slider-vertical-container::after {
            content: "";
            position: absolute;
            bottom: 124px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid rgba(0, 0, 0, 0.7);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 1000;
            pointer-events: none;
        }

        .slider-vertical-container:hover::before,
        .slider-vertical-container:hover::after {
            opacity: 1;
            visibility: visible;
        }

        .slider-ticks {
            position: absolute;
            height: 100%;
            display: flex;
            right: 50px;
            flex-direction: column;
            justify-content: space-between;
        }
        
        /* Style for individual tick marks */
        .slider-tick {
            width: 12px;
            height: 3px;
            background-color: #fff;
            box-shadow: -3px 0px 10px #552000;
            margin: 7px;
        }
        
        .slider-value {
            background-color: white;
            border: solid 2px #FE9900;
            color: #FE9900;
            border-radius: 50px;
            text-align: center;
            font-size: 1rem;
            margin-top: 5px;
            position: absolute;
            bottom: -30px;
            width: 75%;
        }

        /* Container to hold input + dropdown */

        /* Search input styling */
        .search-input {
            width: 100%;
            padding: 10px 12px;
            font-size: 16px;
            border-radius: 50px;
            box-sizing: border-box;
        }

        /* Dropdown results container */
        .search-results {
            position: absolute;
            top: 100%; /* directly below input */
            left: 0;
            right: 0;
            z-index: 1001; /* Higher z-index to appear above recommendations */
            background: white;
            max-height: 10px;
            overflow-y: auto;
            overflow-x: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Each result item */
        .search-results div {
            cursor: pointer;
            transition: background 0.2s ease;
        }

        #searchResults {
            position: absolute;
            width: 100%;
            max-height: 300px;
            overflow-y: auto;
            background-color: #333;
            z-index: 1001; /* Higher z-index to appear above recommendations */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: none;
        }

        .searchResultItem p {
            margin: 0px;
        }
        
        .searchResultItem {
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            position: relative;
            overflow: hidden;
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .searchResultItem:hover {
            transform: scale(1.01);
            background: rgba(150, 150, 150, 0.5);
        }
        
        .searchResultItem-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0.5;
            filter: blur(3px);
            z-index: 0;
            transition: opacity 0.3s;
        }
        
        .searchResultItem-content {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            position: relative;
            z-index: 1;
        }
        
        .searchResultItem-artwork {
            width: 60px;
            height: 60px;
            flex-shrink: 0;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .searchResultItem-artwork img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .searchResultItem-info {
            flex-grow: 1;
        }
        
        .searchResultItem-title {
            font-weight: bold;
            margin: 0;
            color: #ffffff;
        }
        
        .searchResultItem-artist {
            margin: 2px 0 0 0;
            color: #aaa;
            font-size: 0.9em;
        }
        
        /* Style updates for the search results container */
        #searchResults {
            border-radius: 15px;
            max-height: 320px;
            overflow-y: auto;
            background-color: rgba(20, 20, 20, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            scrollbar-width: thin;
            scrollbar-color: #555 #333;
        }

        .recommendation-item {
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            border-radius: 8px;
            margin-top: 10px;
            overflow: hidden;
            position: relative;
            transition: transform 0.2s, background-color 0.2s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .recommendation-item:hover {
            transform: translateX(3px);
            background-color: rgba(40, 40, 40, 0.6);
        }
        
        /* Background album cover */
        .recommendation-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0.5;
            filter: blur(3px);
            z-index: 0;
            transition: opacity 0.3s;
        }
        
        .recommendation-item:hover .recommendation-bg {
            opacity: 0.25;
        }
        
        /* Album cover on the left */
        .recommendation-cover {
            width: 80px;
            height: 80px;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
            margin: 12px;
            border-radius: 4px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .recommendation-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        
        /* Info section */
        .recommendation-info {
            flex: 1;
            padding: 15px 10px;
            position: relative;
            z-index: 1;
        }
        
        .recommendation-title {
            margin: 0 0 6px 0;
            font-weight: bold;
            font-size: 1.1rem;
            color: #ffffff;
        }
        
        .recommendation-artist {
            margin: 0;
            color: #ccc;
            font-size: 0.9rem;
        }
        
        /* Right side with match percentage and links */
        .recommendation-right {
            padding: 12px 15px;
            display: flex;
            flex-direction: column;
            align-items: end;
            justify-content: space-between;
            min-width: 120px;
            position: relative;
            z-index: 1;
        }
        
        .recommendation-match {
            background-color: #ff8530;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 12px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }
        
        .musicLink {
            margin-top: 5px;
        }
        
        .musicLink a {
            color: #ff8530;
            font-size: 0.8rem;
            text-decoration: none;
            transition: color 0.2s, transform 0.2s;
            display: inline-block;
        }
        
        .musicLink a:hover {
            color: #ffc69e;
            transform: translateX(-3px);
        }
        
        /* Recommendations container */


        .recommendations-show {
            background-color: rgba(40, 40, 40, 0.7);
            padding: 15px 20px;
            border-radius: 8px;
            margin: 10px 0 10px 0;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .recommendations-show h3 {
            color: #FE9900;
            margin: 0 0 8px 0;
        }

        .recommendations-show h5 {
            margin: 0px;
        }
        
        .recommendation-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }



        /* Center play control */
        .play-control-container {
            width: 100%;
            display: flex;
            justify-content: center;
        }

        /* Animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .turntable-deck {
                flex-direction: column;
            }
            
            .record-player {
                width: 250px;
                height: 250px;
            }
            
            .slider-vertical-container {
                height: 200px;
                margin-top: 20px;
            }
            
            .recommendation-slider-vertical {
                width: 200px;
            }
            
            .slider-labels-vertical {
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>T u r n t a b l e</h1>
            <p><em>We don't just find songs - we find favorites<em></p>
        </div>
        
        <div class="turntable">
            <div class="turntable-deck">
                <!-- Record player -->
                <div class="record-player">
                    <div class="record-base"></div>
                    <div class="record" id="record">
                        <div class="record-grooves"></div>
                        <div class="album-cover" id="albumCover">
                            <div class="album-cover-placeholder">Album art will appear here</div>
                        </div>
                    </div>
                    <div class="record-arm" id="recordArm"></div>
                </div>

                <div class="control-right">
                    <div class="control-panel">

                        <div class="knob-container">
                            <div class="knob-label">Time Frame</div>
                            <div class="knob" id="timeframeKnob" data-value="0"></div>
                            <div class="knob-value" id="timeframeValue">Any</div>
                        </div>
                        
                        <div class="knob-container">
                            <div class="knob-label">Genre</div>
                            <div class="knob" id="genreKnob" data-value="0"></div>
                            <div class="knob-value" id="genreValue">Any</div>
                        </div>
                    </div>
                </div>

                <div class="slider-vertical-container">
                    <!-- Added tick marks -->
                    <div class="slider-ticks">
                        <div class="slider-tick" title="Recommendation Count: 1"></div>
                        <div class="slider-tick" title="Recommendation Count: 2"></div>
                        <div class="slider-tick" title="Recommendation Count: 3"></div>
                        <div class="slider-tick" title="Recommendation Count: 4"></div>
                        <div class="slider-tick" title="Recommendation Count: 5"></div>
                        <div class="slider-tick" title="Recommendation Count: 6"></div>
                        <div class="slider-tick" title="Recommendation Count: 7"></div>
                        <div class="slider-tick" title="Recommendation Count: 8"></div>
                        <div class="slider-tick" title="Recommendation Count: 9"></div>
                        <div class="slider-tick" title="Recommendation Count: 10"></div>
                    </div>
                    <input type="range" min="1" max="10" value="5" class="recommendation-slider-vertical" id="recommendationSlider">
                    <div class="slider-value" id="sliderValue">5</div>
                </div>

            </div>
            <!-- SEARCH BAR -->
            <div class="search-container">
                <input type="text" id="songSearch" class="search-input" placeholder="Search for a song or artist..." />
                <div id="searchResults" class="search-results"></div>
            </div>
        </div>

        <!-- RECOMMENDATION RESULTS -->
        <div class="recommendationBox"></div>

        <div id="lavaLamp" class="lava-lamp-container">
            <div class="metaballs">
                <svg class="metasvg">
                    <defs>
                        <!-- Enhanced gooey filter with more blur and higher contrast -->
                        <filter id="gooify" width="400%" x="-100%" height="400%" y="-100%">
                            <feGaussianBlur in="SourceGraphic" stdDeviation="30" result="blur" />
                            <feColorMatrix 
                                in="blur" 
                                mode="matrix" 
                                values="1 0 0 0 0
                                       0 1 0 0 0
                                       0 0 1 0 0
                                       0 0 0 40 -10"
                                result="gooey" 
                            />
                        </filter>
                        
                        <!-- Improved glow effect -->
                        <filter id="glowing">
                            <feGaussianBlur stdDeviation="8" result="blur" />
                            <feComposite in="SourceGraphic" in2="blur" operator="over" />
                        </filter>
                        
                        <!-- Richer gradient for more realistic lava appearance -->
                        <linearGradient id="lavaGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" stop-color="#ff3d00" />
                            <stop offset="30%" stop-color="#ff7300" />
                            <stop offset="60%" stop-color="#ffac00" />
                            <stop offset="100%" stop-color="#ffd000" />
                        </linearGradient>
                    </defs>
                    
                    <g filter="url(#gooify)">
                        <!-- More blobs with varying sizes for more organic movement -->
                        <circle class="blobb" id="blob1" r="180" />
                        <circle class="blobb" id="blob2" r="140" />
                        <circle class="blobb" id="blob3" r="160" />
                        <circle class="blobb" id="blob4" r="120" />
                        <circle class="blobb" id="blob5" r="130" />
                        <circle class="blobb" id="blob6" r="90" />
                        <circle class="blobb" id="blob7" r="110" />
                        <circle class="blobb" id="blob8" r="100" />
                        <circle class="blobb" id="blob9" r="85" />
                        <circle class="blobb" id="blob10" r="75" />
                    </g>
                </svg>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check if Vue is available
            if (typeof Vue === 'undefined') {
                console.error('Vue is not loaded! Using plain JavaScript for animation instead.');
                animateLavaLamp();
                return;
            }
            
            // Use Vue if available
            const { createApp } = Vue;
            
            createApp({
                data() {
                    return {
                        blobs: [
                            { id: 'blob1', x: window.innerWidth * 0.4, y: window.innerHeight * 0.3, 
                              xSpeed: 0.3, ySpeed: 0.4, xOffset: 0, yOffset: 0, phase: 0 },
                            { id: 'blob2', x: window.innerWidth * 0.6, y: window.innerHeight * 0.5, 
                              xSpeed: 0.4, ySpeed: 0.5, xOffset: 1, yOffset: 2, phase: 1.5 },
                            { id: 'blob3', x: window.innerWidth * 0.5, y: window.innerHeight * 0.7, 
                              xSpeed: 0.2, ySpeed: 0.3, xOffset: 2, yOffset: 1, phase: 3 },
                            { id: 'blob4', x: window.innerWidth * 0.3, y: window.innerHeight * 0.4, 
                              xSpeed: 0.25, ySpeed: 0.35, xOffset: 3, yOffset: 3, phase: 4.5 },
                            { id: 'blob5', x: window.innerWidth * 0.7, y: window.innerHeight * 0.2, 
                              xSpeed: 0.35, ySpeed: 0.2, xOffset: 4, yOffset: 2, phase: 6 },
                            { id: 'blob6', x: window.innerWidth * 0.2, y: window.innerHeight * 0.6, 
                              xSpeed: 0.15, ySpeed: 0.25, xOffset: 5, yOffset: 5, phase: 7.5 },
                            { id: 'blob7', x: window.innerWidth * 0.8, y: window.innerHeight * 0.3, 
                              xSpeed: 0.3, ySpeed: 0.15, xOffset: 6, yOffset: 4, phase: 9 },
                            { id: 'blob8', x: window.innerWidth * 0.4, y: window.innerHeight * 0.8, 
                              xSpeed: 0.2, ySpeed: 0.3, xOffset: 7, yOffset: 1, phase: 10.5 },
                            { id: 'blob9', x: window.innerWidth * 0.6, y: window.innerHeight * 0.1, 
                              xSpeed: 0.25, ySpeed: 0.2, xOffset: 8, yOffset: 6, phase: 12 },
                            { id: 'blob10', x: window.innerWidth * 0.2, y: window.innerHeight * 0.2, 
                              xSpeed: 0.15, ySpeed: 0.15, xOffset: 9, yOffset: 3, phase: 13.5 }
                        ],
                        bounds: {
                            minX: -100,
                            minY: -100,
                            maxX: window.innerWidth + 100,
                            maxY: window.innerHeight + 100
                        },
                        time: 0
                    };
                },
                mounted() {
                    // Set initial positions
                    this.setInitialPositions();
                    
                    // Update boundaries on window resize
                    window.addEventListener('resize', () => {
                        this.bounds.maxX = window.innerWidth + 100;
                        this.bounds.maxY = window.innerHeight + 100;
                    });
                    
                    // Start animation using requestAnimationFrame for smoother animation
                    this.animate();
                },
                methods: {
                    setInitialPositions() {
                        this.blobs.forEach(blob => {
                            const element = document.getElementById(blob.id);
                            if (element) {
                                element.setAttribute('cx', blob.x);
                                element.setAttribute('cy', blob.y);
                            }
                        });
                    },
                    animate() {
                        // Update time
                        this.time += 0.01;
                        
                        // Update all blob positions
                        this.blobs.forEach(blob => {
                            this.updateBlobPosition(blob);
                        });
                        
                        // Continue animation
                        requestAnimationFrame(this.animate);
                    },
                    updateBlobPosition(blob) {
                        // Use sinusoidal motion for more fluid, organic movement
                        const xWave = Math.sin(this.time * blob.xSpeed + blob.phase) * 50;
                        const yWave = Math.cos(this.time * blob.ySpeed + blob.phase) * 50;
                        
                        // Add slow drift upward to simulate rising heat
                        blob.y -= 0.1;
                        
                        // Add wave motion
                        blob.x += xWave * 0.02;
                        
                        // Boundary checks with smooth transitions
                        if (blob.y < this.bounds.minY) {
                            // When a blob reaches the top, reset it to the bottom
                            blob.y = this.bounds.maxY;
                            // Randomize horizontal position slightly
                            blob.x = Math.max(this.bounds.minX, Math.min(this.bounds.maxX, blob.x + (Math.random() - 0.5) * 100));
                        }
                        
                        if (blob.x < this.bounds.minX) {
                            blob.x = this.bounds.minX;
                            blob.xSpeed = Math.abs(blob.xSpeed);
                        } else if (blob.x > this.bounds.maxX) {
                            blob.x = this.bounds.maxX;
                            blob.xSpeed = -Math.abs(blob.xSpeed);
                        }
                        
                        // Update SVG element position
                        const element = document.getElementById(blob.id);
                        if (element) {
                            element.setAttribute('cx', blob.x);
                            element.setAttribute('cy', blob.y);
                        }
                    }
                }
            }).mount('#lavaLamp');
            
            // Fallback animation function if Vue is not available
            function animateLavaLamp() {
                // Plain JavaScript implementation of the same animation
                // This would be very similar to the Vue implementation but using
                // vanilla JS for state management instead
                console.log('Fallback animation running.');
                
                // Implementation details would go here
            }
        });
    </script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const searchInput = document.getElementById('songSearch');
            const searchResults = document.getElementById('searchResults');
            const albumCover = document.getElementById('albumCover');
            const record = document.getElementById('record');
            const recordArm = document.getElementById('recordArm');
            const recommendationBox = document.querySelector('.recommendationBox');
            
            // Knob controls - only timeframe and genre remain
            const timeframeKnob = document.getElementById('timeframeKnob');
            const timeframeValue = document.getElementById('timeframeValue');
            const genreKnob = document.getElementById('genreKnob');
            const genreValue = document.getElementById('genreValue');
            
            // Slider
            const recommendationSlider = document.getElementById('recommendationSlider');
            const sliderValue = document.getElementById('sliderValue');
            
            let typingTimer;
            const typingDelay = 500;
            
            // Timeframe options
            const timeframes = ['Any', '60s', '70s', '80s', '90s', '2000s', '2010s', '2020s'];
            
            // Genre options
            const genres = ['Any', 'Rock', 'Pop', 'Hip-Hop', 'Electronic', 'Jazz', 'Classical', 'R&B', 'Country', 'Metal'];

            // Track whether a song is playing
            let isPlaying = false;
            
            // Add cursor:pointer to record CSS
            record.style.cursor = 'pointer';
            
            // Function to toggle play/stop
            function togglePlayState() {
                isPlaying = !isPlaying;
                
                if (isPlaying) {
                    record.classList.add('playing');
                    recordArm.style.transform = 'rotate(-15deg)';
                } else {
                    record.classList.remove('playing');
                    recordArm.style.transform = 'rotate(-90deg)';
                }
            }
            
            // Make record clickable
            record.addEventListener('click', togglePlayState);
            
            // Initialize knob positions
            function rotateKnob(knob, value, maxValue) {
                const rotation = value * (270 / maxValue) - 135;
                knob.style.transform = `rotate(${rotation}deg)`;
            }
            
            // Initialize knobs
            rotateKnob(timeframeKnob, timeframeKnob.dataset.value, timeframes.length - 1);
            rotateKnob(genreKnob, genreKnob.dataset.value, genres.length - 1);
            
            // Update knob values
            timeframeValue.textContent = timeframes[timeframeKnob.dataset.value];
            genreValue.textContent = genres[genreKnob.dataset.value];
            
            // Improved knob event listeners
            function setupKnob(knob, valueDisplay, options) {
                let isDragging = false;
                let startAngle = 0;
                let startRotation = 0;
                let currentRotation = 0;
                let knobRect = knob.getBoundingClientRect();
                let knobCenter = {
                    x: knobRect.left + knobRect.width / 2,
                    y: knobRect.top + knobRect.height / 2
                };
                
                // Add visual indication that knobs are interactive
                knob.style.cursor = 'grab';
                
                // Get angle between points
                function getAngle(x1, y1, x2, y2) {
                    return Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);
                }
                
                // Update knob rotation and value display
                function updateKnobValue(rotation) {
                    // Normalize rotation to 0-270 range (-135 to +135 degrees)
                    let normalizedRotation = rotation;
                    while (normalizedRotation < -135) normalizedRotation += 360;
                    while (normalizedRotation > 135) normalizedRotation -= 360;
                    
                    // Clamp to valid range
                    normalizedRotation = Math.max(-135, Math.min(135, normalizedRotation));
                    
                    // Convert to 0-270 scale
                    const normalizedAngle = normalizedRotation + 135;
                    
                    // Calculate value based on angle
                    const value = Math.round(normalizedAngle / (270 / (options.length - 1)));
                    
                    // Update knob
                    knob.style.transform = `rotate(${normalizedRotation}deg)`;
                    knob.dataset.value = value;
                    valueDisplay.textContent = options[value];
                    
                    return normalizedRotation;
                }
                
                knob.addEventListener('mousedown', (e) => {
                    e.preventDefault();
                    
                    // Update knob center position
                    knobRect = knob.getBoundingClientRect();
                    knobCenter = {
                        x: knobRect.left + knobRect.width / 2,
                        y: knobRect.top + knobRect.height / 2
                    };
                    
                    // Get initial angle
                    startAngle = getAngle(knobCenter.x, knobCenter.y, e.clientX, e.clientY);
                    
                    // Get current rotation from transform or default to 0
                    const transform = window.getComputedStyle(knob).getPropertyValue('transform');
                    let matrix = new DOMMatrix(transform);
                    startRotation = Math.atan2(matrix.b, matrix.a) * (180 / Math.PI);
                    currentRotation = startRotation;
                    
                    isDragging = true;
                    knob.style.cursor = 'grabbing';
                    document.body.style.cursor = 'grabbing';
                    
                    knob.classList.add('knob-active');
                });
                
                document.addEventListener('mousemove', (e) => {
                    if (!isDragging) return;
                    
                    // Calculate new angle
                    const currentAngle = getAngle(knobCenter.x, knobCenter.y, e.clientX, e.clientY);
                    const angleDelta = currentAngle - startAngle;
                    
                    // Calculate new rotation
                    let newRotation = startRotation + angleDelta;
                    
                    // Update knob position and value
                    currentRotation = updateKnobValue(newRotation);
                });
                
                document.addEventListener('mouseup', () => {
                    if (isDragging) {
                        isDragging = false;
                        knob.style.cursor = 'grab';
                        document.body.style.cursor = 'default';
                        knob.classList.remove('knob-active');
                        
                        // Update start positions for next drag
                        startRotation = currentRotation;
                    }
                });
                
                // Click to increment/decrement
                knob.addEventListener('click', (e) => {
                    if (e.target !== knob) return; // Make sure we clicked on the knob itself
                    
                    // Update knob center position
                    knobRect = knob.getBoundingClientRect();
                    knobCenter = {
                        x: knobRect.left + knobRect.width / 2,
                        y: knobRect.top + knobRect.height / 2
                    };
                    
                    // Determine if click was on left or right half
                    const isRightSide = e.clientX > knobCenter.x;
                    
                    // Get current value
                    const currentValue = parseInt(knob.dataset.value);
                    
                    // Calculate new value
                    let newValue;
                    if (isRightSide) {
                        newValue = Math.min(currentValue + 1, options.length - 1);
                    } else {
                        newValue = Math.max(currentValue - 1, 0);
                    }
                    
                    // Update knob
                    const newRotation = (newValue * (270 / (options.length - 1))) - 135;
                    knob.style.transform = `rotate(${newRotation}deg)`;
                    knob.dataset.value = newValue;
                    valueDisplay.textContent = options[newValue];
                    
                    // Update start rotation for next drag
                    startRotation = newRotation;
                });
            }
            
            // Set up all knobs
            setupKnob(timeframeKnob, timeframeValue, timeframes);
            setupKnob(genreKnob, genreValue, genres);
            
            // Slider event listener
            recommendationSlider.addEventListener('input', function() {
                sliderValue.textContent = this.value;
            });
            
            // Search input event listener
            searchInput.addEventListener('input', function() {
                clearTimeout(typingTimer);
                
                const query = searchInput.value.trim();
                
                if (query) {
                    // Show the loading message in search results
                    searchResults.innerHTML = '<div class="searchResultItem"><div class="searchResultItem-content"><p>Searching...</p></div></div>';
                    searchResults.style.display = 'block';
                    
                    typingTimer = setTimeout(() => {
                        // Make an actual API call in a real implementation
                        fetch('/api/search', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ query: query })
                        })
                        .then(response => response.json())
                        .then(data => {
                            searchResults.innerHTML = '';
                            
                            // Check if the response contains results
                            if (data.results && data.results.length > 0) {
                                data.results.forEach(track => {
                                    const div = document.createElement('div');
                                    div.className = 'searchResultItem';
                                    div.setAttribute('data-title', track.title);
                                    div.setAttribute('data-artist', track.artist);
                                    div.setAttribute('data-album-cover', track.album_cover);
                                    
                                    // Create the background with the album art
                                    const bg = document.createElement('div');
                                    bg.className = 'searchResultItem-bg';
                                    bg.style.backgroundImage = `url("${track.album_cover}")`;
                                    
                                    // Create the content container
                                    const content = document.createElement('div');
                                    content.className = 'searchResultItem-content';
                                    
                                    // Create album artwork container
                                    const artwork = document.createElement('div');
                                    artwork.className = 'searchResultItem-artwork';
                                    
                                    // Create album cover image
                                    const img = document.createElement('img');
                                    img.src = track.album_cover;
                                    img.alt = `${track.title} album cover`;
                                    artwork.appendChild(img);
                                    
                                    // Create info container
                                    const info = document.createElement('div');
                                    info.className = 'searchResultItem-info';
                                    
                                    // Create title and artist text
                                    const title = document.createElement('p');
                                    title.className = 'searchResultItem-title';
                                    title.textContent = track.title;
                                    
                                    const artist = document.createElement('p');
                                    artist.className = 'searchResultItem-artist';
                                    artist.textContent = track.artist;
                                    
                                    // Assemble the components
                                    info.appendChild(title);
                                    info.appendChild(artist);
                                    content.appendChild(artwork);
                                    content.appendChild(info);
                                    
                                    div.appendChild(bg);
                                    div.appendChild(content);
                                    searchResults.appendChild(div);
                                });
                            } else {
                                searchResults.innerHTML = '<div class="searchResultItem"><div class="searchResultItem-content"><p>No results found.</p></div></div>';
                            }
                        })
                        .catch(error => {
                            console.error('Error searching:', error);
                            searchResults.innerHTML = '<div class="searchResultItem"><div class="searchResultItem-content"><p>Error searching. Try again.</p></div></div>';
                        });
                    }, typingDelay);
                } else {
                    searchResults.innerHTML = '';
                    searchResults.style.display = 'none';
                }
            });
            
            // Hide search results when clicking outside
            document.addEventListener('click', function(event) {
                if (!searchInput.contains(event.target) && !searchResults.contains(event.target)) {
                    searchResults.style.display = 'none';
                }
            });
            
            // Search result click handler
            searchResults.addEventListener('click', function(event) {
                const clicked = event.target.closest('.searchResultItem');
                if (!clicked) return;
                
                const title = clicked.getAttribute('data-title');
                const artist = clicked.getAttribute('data-artist');
                const albumCoverUrl = clicked.getAttribute('data-album-cover');
                
                if (title && artist) {
                    // Update the record player with the selected song
                    albumCover.innerHTML = `<img src="${albumCoverUrl}" alt="${title} by ${artist}">`;
                    searchInput.value = `${title} - ${artist}`;
                    searchResults.style.display = 'none';

                    // Start the record playing
                    if (!isPlaying) {
                        isPlaying = true;
                        record.classList.add('playing');
                        recordArm.style.transform = 'rotate(-15deg)';
                    }
                    
                    // Get current timeframe, genre and recommendations count
                    const timeframe = timeframes[parseInt(timeframeKnob.dataset.value)];
                    const genre = genres[parseInt(genreKnob.dataset.value)];
                    const count = parseInt(recommendationSlider.value);
                    
                    // Show loading in recommendation box
                    recommendationBox.innerHTML = `
                        <div class="recommendations-show">
                            <h3>Loading recommendations for ${title} by ${artist}...</h3>
                            <p>Time Frame: ${timeframe} | Genre: ${genre} | Count: ${count}</p>
                            <h5>Powered by <strong>CadenceAI</strong></h5>
                        </div>
                    `;
                    
                    // Make the API call for recommendations
                    fetch('/api/recommend', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ 
                            track_name: title, 
                            artist_name: artist,
                            timeframe: timeframe === 'Any' ? '' : timeframe,
                            genre: genre === 'Any' ? '' : genre,
                            count: count
                        })
                    })
                    .then(response => response.json())
                    .then(data => {
                        // Create recommendations HTML
                        let recHTML = `
                            <div class="recommendations-show">
                                <h3>Recommended Songs for: ${title} by ${artist}</h3>
                                <p>Time Frame: ${timeframe} | Genre: ${genre}</p>
                                <h5>Powered by <strong>CadenceAI</strong></h5>
                            </div>
                            <div>
                                <ul class="recommendation-list">
                        `;
                        
                        if (data.recommendations && data.recommendations.length > 0) {
                            data.recommendations.forEach(rec => {
                                recHTML += `
                                    <li class="recommendation-item">
                                        <div class="recommendation-bg" style="background-image: url('${rec.album_cover || '/api/placeholder/50/50'}')"></div>
                                        <div class="recommendation-cover">
                                            <img src="${rec.album_cover || '/api/placeholder/50/50'}" alt="${rec.title}">
                                        </div>
                                        <div class="recommendation-info">
                                            <h4 class="recommendation-title">${rec.title}</h4>
                                            <p class="recommendation-artist">${rec.artist}</p>
                                        </div>
                                        <div class="recommendation-right">
                                            <div class="recommendation-match">${rec.similarity_score}% match</div>
                                            <div class="musicLink"><a href="">Listen on Apple Music</a></div>
                                            <div class="musicLink"><a href="">Listen on Spotify</a></div>
                                        </div>
                                    </li>
                                `;
                            });
                        } else {
                            recHTML += `<li class="recommendation-item">No recommendations found</li>`;
                        }
                        
                        recHTML += `
                                </ul>
                            </div>
                        `;
                        
                        recommendationBox.innerHTML = recHTML;
                    })
                    .catch(error => {
                        console.error('Error fetching recommendations:', error);
                        recommendationBox.innerHTML = `
                            <div class="recommendations show">
                                <h3>Error loading recommendations</h3>
                                <p>Please try again later.</p>
                            </div>
                        `;
                    });
                }
            });
        });
    </script>
</body>
</html>